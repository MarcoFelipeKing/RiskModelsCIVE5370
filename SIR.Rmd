---
title: "Risk Model"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    social: menu
    source_code: embed
runtime: shiny
---

```{r setup, include=FALSE}
library(flexdashboard)
library(shiny)
library(dplyr)
library(deSolve)
library(ggplot2)
library(hrbrthemes)
```
Column {.sidebar}
-----------------------------------------------------------------------

```{r}
selectInput(inputId = "quanta",label = "Quanta per hour",choices = c("SARS","Measels"),selected = "SARS")
    
    
numericInput('ach', 'Air changes per hour', 1,
              min = 1, max = 10)

sliderInput(inputId = "quanta",label = "Quanta per hour:", min = 1, max = 50,value=10,step=10)
```

Column {data-width=650}
-----------------------------------------------------------------------

### Chart A

```{r}
## Create an SIR function
sir <- function(time, state, parameters) {

  with(as.list(c(state, parameters)), {

    dS <- -beta * S * I
    dI <-  beta * S * I - gamma * I
    dR <-                 gamma * I

    return(list(c(dS, dI, dR)))
  })
}

### Set parameters
## Proportion in each compartment: Susceptible 0.999999, Infected 0.000001, Recovered 0
init       <- c(S = 1-1e-6, I = 1e-6, R = 0.0)
## beta: infection parameter; gamma: recovery parameter
parameters <- c(beta = 1.4247, gamma = 0.14286)
## Time frame
times      <- seq(0, 70, by = 1)

## Solve using ode (General Solver for Ordinary Differential Equations)
out <- ode(y = init, times = times, func = sir, parms = parameters)
## change to data frame
out <- as.data.frame(out)


```

Column {data-width=350}
-----------------------------------------------------------------------

### Chart B

```{r}
renderPlot({
  plot(out())
}
  
       )
```

### Chart C

```{r}

```

